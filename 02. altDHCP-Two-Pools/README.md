## Настройка DHCP сервера с двумя пулами адресов на базе ALT Server
![image](https://github.com/NyashMan/LinuxSysa/assets/1348639/81760e94-6b14-4d93-8fb5-5a1fc51a5056)  

# Задача:  
Настроить автоматическое распределение IP-адресов на Alt Server, с использованием нескольких пулов-адресации согласно таблице 1.
**Таблица 1**
| Имя пула | Адреса            |
|-----------------|-----------------|
| CLI1             | 192.168.15.0/24 255.255.255.0     |
| CLI2             | 172.16.0.0/24 255.255.255.0     |  

•	a. Учтите, что у клиента CLI1 должен быть зарезервирован **конкретный** адрес - **192.168.15.15**.  
••	Настройка резервации адреса производится на сервере DHCP. Статический адрес на интерфейсе машины - недопустим!  
•	б. CLI2 должен получать адрес из выделенного пула.  
• в. Имена машин должны иметь следующий вид: **CLI1_Фамилия** (пр. **CLI1_Ivanov**); **CLI2_Фамилия** (пр. **CLI2_Ivanov**)  
  
# Server:  
# Предварительная настройка
В данной работе нам понадобится добавить дополнительный сетевой интерфейс в виртуальную машину.  
**Обратите внимание**, что на разных интерфейсах установлены разные Lan Segments!
![image](https://github.com/NyashMan/LinuxSysa/assets/1348639/611c5e20-5298-4aea-84a4-d3f696f3fe75)  
![image](https://github.com/NyashMan/LinuxSysa/assets/1348639/b6b59133-04f6-4f23-a5c3-d528cb826794)  

# Выполнение:  
Задание подразумевает, что [предыдущее задание](https://github.com/NyashMan/LinuxSysa/tree/main/AltDHCP) уже выполнено и вы обладаете знаниями в работе с DHCP-сервером в системе Alt Linux.
В данной работе потребуется:
⋅⋅* Установленная виртуальная машина ALT Linux Workstation (2шт)
⋅⋅* Установленная виртуальная машина ALT Linux Server (минимальный пакет установки)
Все операции будем проводить от имени супер-пользователя (root)  
```
su -
```

# Server:  
Настройка производится на уже установленном сервере Alt с [развёрнутой службой DHCP](https://github.com/NyashMan/LinuxSysa/tree/main/AltDHCP).
Прежде всего внесём изменения в настройки интерфейса сервера. Ранее мы настраивали только один интерфейс на статический адрес, теперь необходимо подготовить второй (в моём случае первым интерфейсом является **ens34** вторым интерфейсом является **ens37**, пример основывается на нём):
```
mkdir /etc/net/ifaces/ens37

```
Предлогается, что интерфейсы ens34 и ens37 являются интрфейсами, которые направлены в сторону клиентов и раздают адреса.  
Проверим содержимое двух файлов с настройками интерфейсов. Они должны быть **идентичны**, соблюдайте порядок записей и регистр!
```
nano /etc/net/ifaces/ens34/options
nano /etc/net/ifaces/ens37/options
```
![image](https://github.com/NyashMan/LinuxSysa/assets/1348639/f5827ba4-93d4-4698-b3f0-74433346a42f)  
Далее зададим статические адреса на данные интерфейсы исходя из поставленной задачи:
```
nano /etc/net/ifaces/ens34/ipv4address
192.168.15.1/24
nano /etc/net/ifaces/ens37/ipv4address
172.16.0.1/24
```
После внесения изменений необходимо произвести перезагрузку сетевой службы:  
```
systemctl restart network
```
Проверим адреса на интерфесах:
```
ip -c a
```
![image](https://github.com/NyashMan/LinuxSysa/assets/1348639/d00140a2-0ee2-4ade-b7f4-2073ed683179)  

Вносим изменения в уже имеющийся файл с интерфейсами, на которых будет работать DHCP-сервер:
```
nano /etc/sysconfig/dhcpd 
```
![image](https://github.com/NyashMan/LinuxSysa/assets/1348639/891c8d54-9e48-4720-a126-5171c279b7d5)  
Предположим, что интерфейс **ens34** "смотрит" в сторону адреса 192.168.15.0, а интрфейс **ens37** - 172.16.0.0  
В таком случае конфигруация будет выглядить следующим образом:
Открываем файл в котором настраиваются пулы DHCP для дальнейшего редактирования:  
```
nano /etc/dhcp/dhcpd.conf
```
![image](https://github.com/NyashMan/LinuxSysa/assets/1348639/f63d441f-f6c5-40dc-97cc-eb45c1593f89)
Учтите, что пункт **hardware ethernet** на вашей машине будет отличаться! Чтобы узнать корректный MAC-адрес интерфеса, необходимо посмотреть его в настройках сети клиента и указать в файле корректный.
#CLI1:
```
ip -c a
```
![image](https://github.com/NyashMan/LinuxSysa/assets/1348639/c724c153-9782-4787-95f3-57fa7d4ba390)  

Производим проверку файла на корректность заполнения:
```
**dhcpd -t -cf /etc/dhcp/dhcpd.conf**
```
Запускаем и добавляем в автозагрузку службу dhcpd:
```
systemctl enable --now dhcpd
```
Проверим статус службы dhcpd:
```
systemctl status dhcpd
```
![image](https://github.com/NyashMan/LinuxSysa/assets/1348639/471498da-1c00-496f-8d07-8049d5ab2fad)  

На этом настройка DHCP сервера окончена.


# CLI1:  
# Предварительная настройка

На двух машинах необходимо сделать дополнительные сетевые интерфейсы и перевести их в режим Lan Segment.
Предположим, что **CLI1** подключен к интерфейсу **ens34**. В таком случае, в машине **CLI1** имеет интерфейс **Lan Segment 1**. Будьте внимательны при настройке! 
Зададим имя нашей машине:
```
hostnamectl set-hostname CLI1; exec bash
```
Проверим, получает ли наш клиент фиксированный ip-адресс от сервера:
```
ip -c a
```
![image](https://github.com/NyashMan/LinuxSysa/assets/1348639/e9acf127-f049-4560-976b-cb67b7d509a6)  

# CLI2:
Для ускорения работы, рекомендуется сделать клон уже существующей машины с Alt Workstation.
На двух машинах необходимо сделать дополнительные сетевые интерфейсы и перевести их в режим Lan Segment.
Предположим, что **CLI2** подключен к интерфейсу **ens37**. В таком случае, в машине **CLI2** имеет интерфейс **Lan Segment 2**. Будьте внимательны при настройке! 

Зададим имя нашей машине:
```
hostnamectl set-hostname CLI2; exec bash
```
Проверим, получает ли наш клиент фиксированный ip-адресс от сервера:

```
ip -c a
```

![image](https://github.com/NyashMan/LinuxSysa/assets/1348639/0d3f1ded-c278-4f60-891e-a308c6f1f2b5)  
